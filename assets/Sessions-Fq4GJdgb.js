import{a as D,r as o,j as e}from"./index-D4v-KAf0.js";const C=()=>{const{sessions:h,trainers:b,dispatchSessions:c,SESSION_ACTIONS:m,getTrainerById:j,checkSessionConflict:N}=D(),[f,l]=o.useState(!1),[n,u]=o.useState(null),[t,i]=o.useState({name:"",date:"",startTime:"",endTime:"",trainerId:""}),d=()=>{i({name:"",date:"",startTime:"",endTime:"",trainerId:""}),u(null)},g=()=>{d(),l(!0)},S=s=>{i(s),u(s),l(!0)},y=s=>{if(s.preventDefault(),!(t.startTime>=t.endTime||N(t.trainerId,t.date,t.startTime,t.endTime,n==null?void 0:n.id))){if(n)c({type:m.UPDATE_SESSION,payload:{...t,id:n.id,status:n.status}});else{const v=new Date(`${t.date}T${t.startTime}`)>new Date?"upcoming":"completed";c({type:m.ADD_SESSION,payload:{...t,status:v}})}l(!1),d()}},T=s=>{window.confirm("Delete this session?")&&c({type:m.DELETE_SESSION,payload:s})},r=s=>{i({...t,[s.target.name]:s.target.value})},x=[...h].sort((s,a)=>new Date(a.date)-new Date(s.date));return e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Sessions"}),e.jsx("button",{onClick:g,className:"btn btn-primary",children:"Schedule Session"})]}),x.length===0?e.jsx("p",{className:"text-center py-8 text-gray-500",children:"No sessions scheduled"}):e.jsx("div",{className:"space-y-2",children:x.map(s=>{const a=j(s.trainerId),p=((new Date(`2000-01-01T${s.endTime}`)-new Date(`2000-01-01T${s.startTime}`))/(1e3*60*60)).toFixed(1);return e.jsxs("div",{className:"card p-4",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:(a==null?void 0:a.name)||"Unknown Trainer"})]}),e.jsx("span",{className:`badge ${s.status==="upcoming"?"badge-success":"badge-default"}`,children:s.status})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-3",children:[s.date," • ",s.startTime," - ",s.endTime," (",p,"h)"]}),e.jsxs("p",{className:"text-xs text-gray-500 mb-3",children:["Skill: ",(a==null?void 0:a.skill)||"N/A"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>S(s),className:"btn btn-outline btn-sm w-20",children:"Edit"}),e.jsx("button",{onClick:()=>T(s.id),className:"btn btn-danger btn-sm w-20",children:"Delete"})]})]},s.id)})}),f&&e.jsx("div",{className:"modal-overlay",onClick:()=>{l(!1),d()},children:e.jsxs("div",{className:"modal-panel",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("span",{className:"font-semibold",children:n?"Edit Session":"Schedule Session"}),e.jsx("button",{className:"text-slate-600",onClick:()=>{l(!1),d()},children:"×"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:y,className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Session Name"}),e.jsx("input",{type:"text",name:"name",value:t.name,onChange:r,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trainer"}),e.jsxs("select",{value:t.trainerId,onChange:s=>i({...t,trainerId:s.target.value}),className:"w-full px-3 py-2 border rounded-lg",required:!0,children:[e.jsx("option",{value:"",children:"Select trainer..."}),b.map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Date"}),e.jsx("input",{type:"date",name:"date",value:t.date,onChange:r,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"Start Time"}),e.jsx("input",{type:"time",name:"startTime",value:t.startTime,onChange:r,className:"w-full px-3 py-2 border rounded-lg",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-1",children:"End Time"}),e.jsx("input",{type:"time",name:"endTime",value:t.endTime,onChange:r,className:"w-full px-3 py-2 border rounded-lg",required:!0})]})]}),e.jsxs("div",{className:"flex gap-2 pt-2",children:[e.jsx("button",{type:"button",className:"btn btn-outline flex-1",onClick:()=>{l(!1),d()},children:"Cancel"}),e.jsx("button",{type:"submit",className:"btn btn-primary flex-1",children:n?"Update":"Schedule"})]})]})})]})})]})};export{C as default};
