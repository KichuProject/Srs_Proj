import{a as v,r as x,j as s}from"./index-D4v-KAf0.js";const I=()=>{const{sessions:h,trainers:p,attendance:i,dispatchAttendance:l,ATTENDANCE_ACTIONS:d,getTrainerById:u,getSessionById:m}=v(),[a,r]=x.useState(""),[c,o]=x.useState(""),j=()=>{if(!a||!c)return;const e=i.find(n=>n.sessionId===a&&n.trainerId===c);if(e!=null&&e.checkInTime)return;const t=m(a);l({type:d.CHECK_IN,payload:{sessionId:a,trainerId:c,timestamp:new Date().toISOString(),sessionStartTime:`${t.date}T${t.startTime}:00`,sessionEndTime:`${t.date}T${t.endTime}:00`}}),r(""),o("")},b=()=>{if(!a||!c)return;const e=i.find(t=>t.sessionId===a&&t.trainerId===c);!(e!=null&&e.checkInTime)||e.checkOutTime||(l({type:d.CHECK_OUT,payload:{sessionId:a,trainerId:c,timestamp:new Date().toISOString()}}),r(""),o(""))},g=e=>{const t={Present:"badge-success",Late:"badge-warning",Missed:"badge-danger",Rejected:"badge-danger"};return s.jsx("span",{className:`badge ${t[e]||"badge-default"}`,children:e})},N=e=>l({type:d.APPROVE_ATTENDANCE,payload:e}),T=e=>window.confirm("Reject this record?")&&l({type:d.REJECT_ATTENDANCE,payload:e});return s.jsxs("div",{className:"space-y-4",children:[s.jsx("h1",{className:"text-3xl font-bold",children:"Attendance"}),s.jsxs("div",{className:"card p-4",children:[s.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Check-In / Check-Out"}),s.jsxs("div",{className:"grid grid-cols-2 gap-2 mb-3",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Session"}),s.jsxs("select",{value:a,onChange:e=>r(e.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[s.jsx("option",{value:"",children:"Select Session"}),h.map(e=>s.jsxs("option",{value:e.id,children:[e.name," - ",e.date]},e.id))]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium mb-1",children:"Trainer"}),s.jsxs("select",{value:c,onChange:e=>o(e.target.value),className:"w-full px-3 py-2 border rounded-lg",children:[s.jsx("option",{value:"",children:"Select Trainer"}),p.map(e=>s.jsx("option",{value:e.id,children:e.name},e.id))]})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("button",{onClick:j,className:"btn btn-success flex-1",children:"Check In"}),s.jsx("button",{onClick:b,className:"btn btn-danger flex-1",children:"Check Out"})]})]}),s.jsxs("div",{className:"card p-4",children:[s.jsx("h2",{className:"text-lg font-bold mb-3",children:"Attendance History"}),i.length===0?s.jsx("p",{className:"text-center py-6 text-gray-500",children:"No records"}):s.jsx("div",{className:"space-y-2",children:i.map(e=>{const t=u(e.trainerId),n=m(e.sessionId);return s.jsxs("div",{className:"border rounded-lg p-3",children:[s.jsxs("div",{className:"flex justify-between items-start mb-2",children:[s.jsxs("div",{children:[s.jsxs("p",{className:"font-semibold",children:[t==null?void 0:t.name," - ",n==null?void 0:n.name]}),s.jsx("p",{className:"text-sm text-gray-600",children:n==null?void 0:n.date})]}),s.jsxs("div",{className:"flex flex-col gap-1",children:[g(e.status),s.jsxs("div",{className:"flex gap-1",children:[!e.approved&&e.status!=="Rejected"&&s.jsxs(s.Fragment,{children:[s.jsx("button",{onClick:()=>N(e.id),className:"btn btn-success btn-sm text-xs",children:"Approve"}),s.jsx("button",{onClick:()=>T(e.id),className:"btn btn-danger btn-sm text-xs",children:"Reject"})]}),e.approved&&s.jsx("span",{className:"badge badge-success text-xs",children:"Approved"})]})]})]}),s.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:["In:"," ",e.checkInTime?new Date(e.checkInTime).toLocaleTimeString():"-"," ","| Out:"," ",e.checkOutTime?new Date(e.checkOutTime).toLocaleTimeString():"-"," ","| ",e.workingHours||0,"h"]})]},e.id)})})]})]})};export{I as default};
